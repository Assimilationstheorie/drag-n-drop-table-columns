/*
 Drag & Drop Table Columns v.0.1.3
 by Oleksandr Nikitin (a.nikitin@i.ua)
 https://github.com/alexshnur/drag-n-drop-table-columns
 */
!function(n,e){function t(n,e){return e.parentNode.insertBefore(n,e.nextSibling)}function r(){var n=navigator.userAgent.toLowerCase();return-1!==n.indexOf("msie")?parseInt(n.split("msie")[1]):!1}var a,o,i,d=null,s=null;return o=function(){function e(e,t){i=this,o=e,i.options=n.extend({},i.options,t),i.options.drag&&(9===r()&&o.find("thead tr th").each(function(){0===n(this).find(".drag-ie").length&&n(this).html(n("<a>").html(n(this).html()).attr("href","#").addClass("drag-ie"))}),a=o.find("thead tr th"),jQuery.event.props.push("dataTransfer"),[].forEach.call(a,function(e){e.setAttribute("draggable",!0),n(e).on("dragstart",i.handleDragStart),n(e).on("dragenter",i.handleDragEnter),n(e).on("dragover",i.handleDragOver),n(e).on("dragleave",i.handleDragLeave),n(e).on("drop",i.handleDrop),n(e).on("dragend",i.handleDragEnd)}))}var o;return e.prototype={options:{drag:!0,dragClass:"drag",overClass:"over",movedContainerSelector:".dnd-moved"},handleDragStart:function(e){n(this).addClass(i.options.dragClass),d=this,e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("text/html",this.id)},handleDragOver:function(n){return n.preventDefault&&n.preventDefault(),n.dataTransfer.dropEffect="copy",!1},handleDragEnter:function(e){return s=this,[].forEach.call(a,function(e){n(e).removeClass(i.options.overClass)}),n(this).addClass(i.options.overClass),!1},handleDragLeave:function(n){},handleDrop:function(e){return e.stopPropagation&&e.stopPropagation(),d!==e&&i.moveColumns(n(d).index(),n(this).index()),!1},handleDragEnd:function(e){var t={};return[].forEach.call(a,function(e){n(e).removeClass(i.options.overClass);var r=n(e).attr("data-name"),a=n(e).index();r&&(t[r]=a)}),"function"==typeof i.options.onDragEnd&&i.options.onDragEnd(t)&&n(d).removeClass(i.options.dragClass),!1},moveColumns:function(n,e){for(var r=o.find(i.options.movedContainerSelector),a=0;a<r.length;a++)e>n?t(r[a].children[n],r[a].children[e]):e<o.find("thead tr th").length-1&&r[a].insertBefore(r[a].children[n],r[a].children[e])}},e}(),n.fn.extend({dragableColumns:function(){var e=arguments[0];return this.each(function(){var t=n(this);new o(t,e)})}})}(window.jQuery,window);